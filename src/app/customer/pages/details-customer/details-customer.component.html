<br />
<div class="container-fluid">
  <h2 class="text-center">Detalle de Cliente</h2>
  <br />

  <div *ngIf="!customerApi; else divContenido" class="text-center">

  <div *ngIf="!user; else divContenido" class="text-center">

    <img
      class="img-loading"
      src="../../../../assets/img/loading-gif.gif"
      alt="loading-gif"
    /> 
  </div>
  <!--  div contenido -->
  <ng-template #divContenido>
    <section>
      <div class="card">
        <div class="card-title fw-bolder">Datos Personales</div>
        <div class="card-body">
          <div class="row">
            <div class="col-sm-12 col-md-4">
              <label class="fw-bold" for="name">
                {{

                  customerApi.type === 2

                  user.type_customer === "business"

                    ? "Razón Social"
                    : "Nombre y Apellido"
                }}
              </label>
              <br />
              <label for="">
                {{

                  customerApi.type === 2
                    ? customerApi.firstname
                    : customerApi.firstname +
                      " " +
                      customerApi.lastname

                  user.type_customer === "business"
                    ? user.first_name
                    : user.first_name +
                      " " +
                      user.last_name

                }}
              </label>
            </div>
            <div class="col-sm-12 col-md-4">
              <label class="fw-bold" for="">Tipo de Documento:</label>
              <br />
              <label for="">{{

                customerApi.type === 2 ? "RUC" : "DNI"

                user.type_customer === "business" ? "RUC" : "DNI"

              }}</label>
            </div>
            <div class="col-sm-12 col-md-4">
              <label class="fw-bold" for="">Nº de Doc:</label>
              <br />

              <label for="">{{ customerApi.numberdoc }}</label>

              <label for="">{{ user.number_doc }}</label>

            </div>
          </div>
          <div class="row">
            <div class="col-sm-12 col-md-4">
              <label class="fw-bold" for="name">Dirección:</label>
              <br />

              <label for=""> {{ customerApi.address }} </label>

              <label for=""> {{ user.address }} </label>

            </div>
            <div class="col-sm-12 col-md-4">
              <label class="fw-bold" for="">Teléfono:</label>
              <br />

              <label for="">{{ customerApi.phone }}</label>

              <label for="">{{ user.phone }}</label>

            </div>
            <div class="col-sm-12 col-md-4">
              <label class="fw-bold" for="">Tipo de Cliente:</label>
              <br />
              <label for="">

                {{ customerApi.type === 2 ? "Empresa" : "Persona" }}

                {{ user.type_customer === "business" ? "Empresa" : "Persona" }}

              </label>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Fin card personal -->
    <br />
    <!-- card Cuentas -->

    <section *ngIf="accountsxCustomerApi.length > 0">

    <section *ngIf="accounts.length > 0">

      <div class="card">
        <div class="card-title fw-bolder">
          <div class="row">
            <div class="col">Cuentas</div>
            <!--  <div class="col monto"> {{AmountTotal}} </div> -->
          </div>
        </div>
        <div class="card-body">
          <div class="container table-responsive">
            <table class="table table-striped table-bordered table-cuentas">
              <thead>
                <tr class="color-cabecera">
                  <th>NÚMERO DE CUENTA Y TIPO</th>
                  <!-- <th class="monto">SALDO CONTABLE</th> -->
                  <th class="monto">SALDO DISPONIBLE</th>
                </tr>
              </thead>
              <tbody>
                <!-- '../../customerproducts/', -->
                <tr

                  *ngFor="let item of accountsxCustomerApi"
                  [routerLink]="[
                    '../../customerproducts/',
                    item.id, 'account'

                  *ngFor="let accountItem of accounts"
                  [routerLink]="[
                  'customerproducts/',
                  accountItem.id, 'account'

                  ]"
                >
                  <td>
                    <div style="width: 100%">
                      <span class="link">

                        {{ item.numberaccount | cardNumber }} </span
                      ><br />
                      <small> {{ item.product.name }} </small>

                        {{ accountItem.account_number | cardNumber }} </span
                      ><br />
                      <small> {{ accountItem.account_type | i18nSelect:accountsMap }} </small>

                    </div>
                  </td>
                  <!-- <td class="td">S/ 100.00</td> -->
                  <td class="">
                    <div class="row">
                      <div class="col-sm-3">
                        <!-- {{ item.currency | currencytable }} -->
                      </div>
                      <div class="col td">
                        {{ accountItem.balance | currencytable:accountItem.currency }}
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
    <!-- fin card cuentas -->
    <br />
    <!-- card Credits -->

    <section *ngIf="creditsxCustomerApi.length > 0">

    <section *ngIf="loans.length > 0">

      <div class="card">
        <div class="card-title fw-bolder">Créditos</div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-bordered">
              <thead>
                <tr class="color-cabecera">
                  <th>NÚMERO DE CRÉDITO Y TIPO</th>
                  <th class="monto">MONTO PRÉSTADO</th>
                  <th class="monto">INTERÉS</th>
                  <th class="monto">MONTO MENSUAL</th>
                </tr>
              </thead>
              <tbody>
                <tr

                  *ngFor="let item2 of creditsxCustomerApi"
                  [routerLink]="[
                    '../../customerproducts/',
                    item2.id, 'credit'

                  *ngFor="let loanItem of loans"
                  [routerLink]="[
                  'customerproducts/',
                    loanItem.id, 'credit'

                  ]
                   
                   "
                >
                  <td>
                    <div>
                      <span class="link">

                        {{ item2.numbercredit | cardNumber }} </span
                      ><br />
                      <small> {{ item2.product.name }} </small>

                        {{ loanItem.loan_number | cardNumber }} </span
                      ><br />
                      <small> Préstamo {{ loanItem.type === 'personal'? 'personal' : 'Empresa' }} </small>

                    </div>
                  </td>
                  <td class="">
                    <div class="row">
                      <div class="col-sm-3">
                        <!-- {{ item2.currency | currencytable:'PEN' }} -->
                      </div>
                      <div class="col td">

                        {{ item2.amountborrowed | number }}

                        {{ loanItem.capital_amount | currencytable:loanItem.currency }}

                      </div>
                    </div>
                  </td>
                  <td class="text-center">
                    {{ loanItem.interest_rate }}%
                  </td>
                  <td>
                    <div class="row">
                      <div class="col-sm-3">
                        <!-- {{ item2.currency | currencytable }} -->
                      </div>
                      <div class="col td">

                        {{ item2.monthlyamount | number }}

                        {{ loanItem.monthly_fee | currencytable:loanItem.currency }}

                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
    <br/>
    <!-- end card credtios  -->
    <!-- card Card Credits -->

    <section *ngIf="cardsCreditApi.length > 0">

    <section *ngIf="creditCards.length > 0">

      <div class="card">
        <div class="card-title fw-bolder">Tarjetas de Créditos</div>
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-striped table-bordered">
              <thead>
                <tr class="color-cabecera">
                  <th>NÚMERO DE TARJETA Y TIPO</th>
                  <th class="monto">LÍNEA DE CRÉDITO</th>
                  <th class="monto">LÍNEA DISPONIBLE</th>
                </tr>
              </thead>
              <tbody>
                <tr

                  *ngFor="let item2 of cardsCreditApi"
                  [routerLink]="[
                    '../../customerproducts/',
                    item2.id, 'card-credit'

                  *ngFor="let creditCardItem of creditCards"
                  [routerLink]="[
                    'customerproducts/',
                    creditCardItem.id, 'card-credit'

                  ]"
                >
                  <td>
                    <div>
                      <span class="link">

                        {{ item2.numbercard | cardNumber }} </span
                      ><br />
                      <small> {{ item2.product.name }} </small>

                        {{ creditCardItem.credit_card_number | cardNumber }} </span
                      ><br />
                      <small> Tarjeta de Crédito </small>

                    </div>
                  </td>
                  <td class="">
                    <div class="row">
                      <div class="col-sm-3">
                        <!-- {{ item2.currency | currencytable }} -->
                      </div>
                      <div class="col td">

                        {{ item2.creditline| number }}

                        {{ creditCardItem.credit_line| currencytable:creditCardItem.currency }}

                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="row">
                      <div class="col-sm-3">
                        <!-- {{ item2.currency | currencytables }} -->
                      </div>
                      <div class="col td">

                        {{ item2.availableline | number  }}

                        {{ creditCardItem.available_line | currencytable:creditCardItem.currency  }}

                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <button 
        type="button" 
        class="btn btn-primary mt-3" 
        data-bs-toggle="modal" 
        data-bs-target="#exampleModal"
      >
        Nuevo producto
      </button>

      <app-modal  
        formOpen = "createProductForm" 
          
        dniRuc = "3232"
          
      ></app-modal>


    </section>
    <!-- end card Tarjetas  -->
  </ng-template>
  <!--  end div contenido -->
</div>
